query_campaign_summaries_wap;select a.metrics as metrics, a.ad_client_type as ad_client_type, sum(a.impressions) as impressions, sum(a.clicks) as clicks, camp.CPC as cpc,camp.CPM as cpm, ((sum(a.clicks)/sum(a.impressions))*100) as ctr,sum(a.cost) as amount_spent,sum(a.gross_profit) as gross_profit,sum(a.zestadz_revenue) as zestadz_revenue, adv.name as advertiser_name,camp.campaign_name as campaign_name,ad.name as ad_name,a.country as country_name,adv.id as advertiser_id,camp.id as campaign_id,a.ad_id as ad_id,hour(a.delivery_time) as delivery_hour,date(a.delivery_time) as delivery_date from advertisers adv, campaigns camp,ads ad,adsdeliveries a where  a.campaign_id = camp.id and  a.ad_client_type = 'WAP' and a.advertiser_id = adv.id and ad.id=a.ad_id and delivery_time>=concat(if(hour(curTime())='00' or hour(curTime())='01',DATE_ADD(CURDATE(), INTERVAL -1 DAY),curDate()),' ',if(hour(curTime())='00',22,if(hour(curTime())='01',23,hour(subtime(curTime(),'0 2:0:0')))),':00:00') and delivery_time<=concat(if(hour(curTime())='00' or hour(curTime())='01',DATE_ADD(CURDATE(), INTERVAL -1 DAY),curDate()),' ',if(hour(curTime())='00',22,if(hour(curTime())='01',23,hour(subtime(curTime(),'0 2:0:0')))),':59:59') group by delivery_date, delivery_hour, a.ad_id order by null
query_campaign_summaries_sms;select  a.metrics as metrics, a.ad_client_type as ad_client_type,sum(a.impressions) as impressions,camp.CPC as cpc,camp.CPM as cpm, sum(a.cost) as amount_spent,sum(a.gross_profit) as gross_profit,sum(a.zestadz_revenue) as zestadz_revenue, adv.name as advertiser_name,camp.campaign_name as campaign_name,ad.name as ad_name,a.country as country_name,adv.id as advertiser_id,camp.id as campaign_id,a.ad_id as ad_id,hour(a.delivery_time) as delivery_hour,date(a.delivery_time) as delivery_date from advertisers adv, campaigns camp, ads ad,adsdeliveries a where  camp.id=a.campaign_id   and  a.ad_client_type = 'SMS' and a.advertiser_id = adv.id and ad.id=a.ad_id and delivery_time>=concat(if(hour(curTime())='00' or hour(curTime())='01',DATE_ADD(CURDATE(), INTERVAL -1 DAY),curDate()),' ',if(hour(curTime())='00',22,if(hour(curTime())='01',23,hour(subtime(curTime(),'0 2:0:0')))),':00:00') and delivery_time<=concat(if(hour(curTime())='00' or hour(curTime())='01',DATE_ADD(CURDATE(), INTERVAL -1 DAY),curDate()),' ',if(hour(curTime())='00',22,if(hour(curTime())='01',23,hour(subtime(curTime(),'0 2:0:0')))),':59:59') group by delivery_date, delivery_hour, a.ad_id order by null
query_carrier;select  carrier_name as owner,count(carrier_name) as requests,campaign_id as campaign_id,ad_id as ad_id,hour(delivery_time) as delivery_hour,date(delivery_time) as delivery_date from adsdeliveries where delivery_time>=concat(if(hour(curTime())='00' or hour(curTime())='01',DATE_ADD(CURDATE(), INTERVAL -1 DAY),curDate()),' ',if(hour(curTime())='00',22,if(hour(curTime())='01',23,hour(subtime(curTime(),'0 2:0:0')))),':00:00') and delivery_time<=concat(if(hour(curTime())='00' or hour(curTime())='01',DATE_ADD(CURDATE(), INTERVAL -1 DAY),curDate()),' ',if(hour(curTime())='00',22,if(hour(curTime())='01',23,hour(subtime(curTime(),'0 2:0:0')))),':59:59') group by owner,delivery_date, delivery_hour, ad_id order by null
query_deviceproperties;select user_agent as user_agent ,count(user_agent) as requests,campaign_id as campaign_id,ad_id as ad_id,hour(delivery_time) as delivery_hour,date(delivery_time) as delivery_date from adsdeliveries where delivery_time>=concat(if(hour(curTime())='00' or hour(curTime())='01',DATE_ADD(CURDATE(), INTERVAL -1 DAY),curDate()),' ',if(hour(curTime())='00',22,if(hour(curTime())='01',23,hour(subtime(curTime(),'0 2:0:0')))),':00:00') and delivery_time<=concat(if(hour(curTime())='00' or hour(curTime())='01',DATE_ADD(CURDATE(), INTERVAL -1 DAY),curDate()),' ',if(hour(curTime())='00',22,if(hour(curTime())='01',23,hour(subtime(curTime(),'0 2:0:0')))),':59:59') group by user_agent, delivery_date, delivery_hour, ad_id order by null
query_geolocations;select continent_code as continent_code,count(continent_code) as requests,country_code as country_code,continent_name as continent_name,country as country_name,region as region_name,campaign_id as campaign_id,ad_id as ad_id, hour(delivery_time) as delivery_hour,date(delivery_time) as delivery_date from adsdeliveries where delivery_time>=concat(if(hour(curTime())='00' or hour(curTime())='01',DATE_ADD(CURDATE(), INTERVAL -1 DAY),curDate()),' ',if(hour(curTime())='00',22,if(hour(curTime())='01',23,hour(subtime(curTime(),'0 2:0:0')))),':00:00') and delivery_time<=concat(if(hour(curTime())='00' or hour(curTime())='01',DATE_ADD(CURDATE(), INTERVAL -1 DAY),curDate()),' ',if(hour(curTime())='00',22,if(hour(curTime())='01',23,hour(subtime(curTime(),'0 2:0:0')))),':59:59') group by  continent_code,country_code,region_name,delivery_date, delivery_hour,ad_id order by null
query_handsets;select device_name manufacturer ,count(device_name) as requests,campaign_id as campaign_id,ad_id as ad_id,hour(delivery_time) as delivery_hour,date(delivery_time) as delivery_date from adsdeliveries where delivery_time>=concat(if(hour(curTime())='00' or hour(curTime())='01',DATE_ADD(CURDATE(), INTERVAL -1 DAY),curDate()),' ',if(hour(curTime())='00',22,if(hour(curTime())='01',23,hour(subtime(curTime(),'0 2:0:0')))),':00:00') and delivery_time<=concat(if(hour(curTime())='00' or hour(curTime())='01',DATE_ADD(CURDATE(), INTERVAL -1 DAY),curDate()),' ',if(hour(curTime())='00',22,if(hour(curTime())='01',23,hour(subtime(curTime(),'0 2:0:0')))),':59:59') group by  manufacturer ,delivery_date, delivery_hour, ad_id order by null

