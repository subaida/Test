<?xml version="1.0" encoding="iso-8859-1"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>FusionMaps Documentation</title>
<link rel="stylesheet" type="text/css" href="Style.css" />
</head>

<body>
<table width="98%" border="0" cellspacing="0" cellpadding="3" align="center">
  <tr> 
    <td><h2 class="pageHeader">FusionMaps with PHP &gt; Plotting data from Database &gt; Database Structure </h2></td>
  </tr>
  <tr>
    <td valign="top" class="text">Before going deeper into the codes and their logics, let us look at the database   structure first. The database has been named as FusionMapsDB.</td>
  </tr>
  <tr>
    <td valign="top" class="text">&nbsp;</td>
  </tr>
  <tr>
    <td valign="top" class="highlightBlock">The  MySQL dump of the database is present in <span class="codeInline">Download Package &gt; Code &gt; PHP &gt; DB_Drill &gt; DB.</span></td>
  </tr></table>
<table width="98%" border="0" cellspacing="0" cellpadding="3" align="center"><tr></tr>
  <tr>
    <td valign="top" class="text">&nbsp;</td>
  </tr>
  <tr>
    <td valign="top" class="header">Tables</td>
  </tr>
  <tr>
    <td height="26" valign="top" class="text">We have used 4 tables in the database, here are the details of all the tables. </td>
  </tr>
  <tr>
    <td height="16" valign="top" class="header1">Table name: <span class="codeInline">fcmp_master </span></td>
  </tr>
  <tr>
    <td valign="top" class="text">&nbsp;</td>
  </tr>
  <tr>
    <td valign="top" class="text">This table stores the intenal IDs of each state in&nbsp; US map and their corresponding map file names. </td>
  </tr>
  <tr>
    <td valign="top" ><table  class="tableWithBorder tableAlternate" width="100%" cellspacing="0" cellpadding="0" border="0">
        <tr class="text tableAlternateHeader">
          <td width="13%" align="left" valign="top" class="fieldcolumn"><strong>Field</strong></td>
          <td width="14%" align="left" valign="top" class="fieldcolumn"><strong>Type</strong></td>
          <td width="63%" align="left" valign="top" class="fieldcolumn"><strong>Description</strong></td>
        </tr>
        <tr class="text">
          <td align="left" valign="top" class="codeInline"><p class="normal">Internal_Id</p></td>
          <td align="left" valign="top" class="codeInline"><p class="normal">varchar(10)</p></td>
          <td align="left" valign="top"><p class="normal">This represents individual State present in the   US MAP. </p></td>
        </tr>
        <tr class="text tableAlternateDark">
          <td align="left" valign="top" class="codeInline"><p class="normal">s_name</p></td>
          <td align="left" valign="top" class="codeInline"><p class="normal">varchar(10)</p></td>
          <td align="left" valign="top"><p class="normal">This stores short name of the states in US MAP. </p></td>
        </tr>
        <tr class="text">
          <td align="left" valign="top" class="codeInline"><p class="normal">l_name</p></td>
          <td align="left" valign="top" class="codeInline"><p class="normal">varchar(50)</p></td>
          <td align="left" valign="top"><p class="normal">This stores full name of the states in US MAP. </p></td>
        </tr>
        <tr class="text tableAlternateDark">
          <td align="left" valign="top" class="codeInline"><p class="normal">map_swf</p></td>
          <td align="left" valign="top" class="codeInline"><p class="normal">varchar(50)</p></td>
          <td align="left" valign="top"><p class="normal">This is FusionMap Flash File name.</p></td>
        </tr>
    </table></td>
  </tr>
  <tr>
    <td valign="top" class="text">We use different .swf files to display different maps. This table stores the .swf file name required to display the maps in our example along with the Internal Ids of that map. We also store abbreviated and real names of the parts of the maps in this table. </td>
  </tr>
  <tr>
    <td valign="top" class="text">&nbsp;</td>
  </tr>
  <tr>
    <td valign="top" class="header1">Table name: <span class="codeInline">fcmap_group_master</span></td>
  </tr>
  <tr>
    <td valign="top" class="text">&nbsp;</td>
  </tr>
  <tr>
    <td valign="top" class="text">This table stores the names of major Category groups regarding employment.</td>
  </tr>
  <tr>
    <td valign="top" class="text"><table width="100%" cellspacing="0" cellpadding="0" border="0" class="tableWithBorder tableAlternate">
        <tr class="tableAlternateHeader">
          <td align="left" valign="top" width="13%" class="text"><strong>Field</strong></td>
          <td align="left" valign="top" width="14%" class="text"><strong>Type</strong></td>
          <td align="left" valign="top" width="63%" class="text"><strong>Description</strong></td>
        </tr>
        <tr>
          <td align="left" class="codeInline" valign="top">group_id</td>
          <td align="left" class="codeInline" valign="top">int(10)</td>
          <td align="left" class="text" valign="top">Group ID i.e 1,2,3 </td>
        </tr>
        <tr class="tableAlternateDark">
          <td align="left" class="codeInline" valign="top"><p class="normal">group_name</p></td>
          <td align="left" class="codeInline" valign="top"><p class="normal">varchar(50)</p></td>
          <td align="left" class="text" valign="top"><p class="normal">Group Name i.e business, service, unemployed</p></td>
        </tr>
    </table></td>
  </tr>
  <tr>
    <td valign="top" class="text">This table stores the name and id of the employment groups, i.e. Business and Service. It also stores 'Unemployed' as a group here. </td>
  </tr>
  <tr>
    <td valign="top" class="text">&nbsp;</td>
  </tr>
  <tr>
    <td valign="top" class="header1">Table name: <span class="codeInline">fcmap_subgroup_master</span></td>
  </tr>
  <tr>
    <td valign="top" class="text">&nbsp;</td>
  </tr>
  <tr>
    <td valign="top" class="text">This table stores the subgorup names for each of the groups said above. </td>
  </tr>
  <tr>
    <td valign="top" class="text"><table width="100%" cellspacing="0" cellpadding="0" border="0"  class="tableWithBorder tableAlternate">
        <tr class="text tableAlternateHeader">
          <td align="left" valign="top" width="13%" class="fieldcolumn"><strong>Field</strong></td>
          <td align="left" valign="top" width="14%" class="fieldcolumn"><strong>Type</strong></td>
          <td align="left" valign="top" width="63%" class="fieldcolumn"><strong>Description</strong></td>
        </tr>
        <tr class="text">
          <td align="left" valign="top" class="codeInline"><p class="normal">group_id</p></td>
          <td align="left" valign="top" class="codeInline"><p class="normal">int(10)</p></td>
          <td align="left" valign="top"><p class="normal">Group id of Group Master </p></td>
        </tr>
        <tr class="text tableAlternateDark">
          <td align="left" valign="top" class="codeInline">subgroup_id</td>
          <td align="left" valign="top" class="codeInline">int(10)</td>
          <td align="left" valign="top">Subgroup id i.e 1,2,3,4</td>
        </tr>
        <tr class="text">
          <td align="left" valign="top" class="codeInline"><p class="normal">subgroup_name</p></td>
          <td align="left" valign="top" class="codeInline"><p class="normal">varchar(50)</p></td>
          <td align="left" valign="top"><p class="normal">Subgroup name of individual Group Master i.e business -&gt; software , business -&gt; automobile</p></td>
        </tr>
    </table></td>
  </tr>
  <tr>
    <td valign="top" class="text">Each group is divided into various sub-groups, e.g.
      <ul>
        <li>We divide Business into Automobile, Communication, Evergy, Finance and Software subgroups.</li>
        <li>We divide Service into Administration, Education, Law, Postal and Security subgroups.</li>
        <li>We divide Unemplyed group into different age-groups like 20-30 years, 30-40 years, 40-50 years, 50-60 years and 60 above.</li>
      </ul>
    This table stores subgroup names, unique subgroup ids and the parent group id for each subgroup. </td>
  </tr>
  <tr>
    <td valign="top" class="text">&nbsp;</td>
  </tr>
  <tr>
    <td valign="top" class="header1">Table name: <span class="codeInline">fcmap_distribution</span></td>
  </tr>
  <tr>
    <td valign="top" class="text">&nbsp;</td>
  </tr>
  <tr>
    <td valign="top" class="text">This table stores the data for each subgroup for each entity for each state. Hence, this table is the main storehouse of data which we will use in our code. </td>
  </tr>
  <tr>
    <td valign="top" class="text"><table width="100%" cellspacing="0" cellpadding="0" border="0" class="tableWithBorder tableAlternate">
        <tr class="text tableAlternateHeader">
          <td align="left" width="13%" valign="top" ><strong>Field</strong></td>
          <td align="left" width="14%" valign="top" ><strong>Type</strong></td>
          <td align="left" width="63%" valign="top" ><strong>Description</strong></td>
        </tr>
        <tr class="text">
          <td align="left" valign="top" class="codeInline"><p class="normal">Internal_Id</p></td>
          <td align="left" valign="top" class="codeInline"><p class="normal">varchar(10)</p></td>
          <td align="left" valign="top"><p class="normal">This represents individual State present in the   USA MAP [Internal Id from fcmap_master]</p></td>
        </tr>
        <tr class="text tableAlternateDark">
          <td align="left" valign="top" class="codeInline"><p class="normal">entity_id</p></td>
          <td align="left" valign="top" class="codeInline"><p class="normal">varchar(10)</p></td>
          <td align="left" valign="top"><p class="normal">This represents individual internal id of eatch USA State entity. </p></td>
        </tr>
        <tr class="text">
          <td align="left" valign="top" class="codeInline"><p class="normal">group_id</p></td>
          <td align="left" valign="top" class="codeInline"><p class="normal">int(10)</p></td>
          <td align="left" valign="top"><p class="normal">group id related to <span class="codeInline">fcmap_group_master</span></p></td>
        </tr>
        <tr class="text tableAlternateDark">
          <td align="left" valign="top" class="codeInline"><p class="normal">subgroup_id</p></td>
          <td align="left" valign="top" class="codeInline"><p class="normal">int(10)</p></td>
          <td align="left" valign="top"><p class="normal">subgroup id related to <span class="codeInline">fcmap_subgroup_master</span> </p></td>
        </tr>
        <tr class="text">
          <td align="left" valign="top" class="codeInline"><p class="normal">data</p></td>
          <td align="left" valign="top" class="codeInline"><p class="normal">numeric(10)</p></td>
          <td align="left" valign="top"><p><strong>This field stores the actual population data for each sub group of each county of each state of US. </strong></p></td>
        </tr>
    </table></td>
  </tr>
  <tr>
    <td valign="top" class="text"><span class="codeInline">fcmap_distribution</span> stores the actual data that are to be plotted in our example. It stores the number of people in each of the subgroups mentioned above along with respective subgroup id, group id, county code and state code. </td>
  </tr>
  
  <tr>
    <td valign="top" class="text">&nbsp;</td>
  </tr>
  <tr>
    <td valign="top" class="text">Now, let's look at the Relations among these tables </td>
  </tr>
  <tr>
    <td valign="top" class="header">Relations</td>
  </tr>
  <tr>
    <td valign="top" class="text">&nbsp;</td>
  </tr>
  <tr>
    <td valign="top" class="text"><table width="100%"  class="tableWithBorder tableAlternate" cellspacing="0" cellpadding="0" border="0">
        
        <tr class="text tableAlternateDark">
          <td align="left" valign="top"><strong>fcmap_group_master.group_id = fcmap_subgroup_master.subgroup_id</strong> [Link with fcmap_group_master and fcmap_subgroup_master Table]</td>
        </tr>
        <tr class="text">
          <td align="left" valign="top"><strong>fcmap_distribution.group_id = fcmap_group_master.group_id</strong> [Link with fcmap_distribution and fcmap_group_master Table] </td>
        </tr>
        <tr class="text tableAlternateDark">
          <td align="left" valign="top"><strong>fcmap_distribution.subgroup_id = fcmap_subgroup_master.subgroup_id </strong>[Link with fcmap_distribution and fcmap_subgroup_master Table] </td>
        </tr>
        <tr class="text">
          <td align="left" valign="top"><strong>fcmap_master.Internal_Id = fcmap_distribution.Internal_Id</strong> [Link with fcmap_master and fcmap_distribution Table] </td>
        </tr>
    </table></td>
  </tr>
</table>
</body>
</html>
